<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <title>Snap! Build Your Own Blocks. Beta</title>
    <link rel="shortcut icon" href="favicon.ico">
    <script src="jschannel.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
    <script type="text/javascript" src="underscore-min.js"></script>
    <!--<script type="text/javascript" src='gradingLog.js'></script>-->
    <script type="text/javascript" src='spriteEventLog.js'></script>
    <script type="text/javascript" src='scriptAnalysis.js'></script>
    <meta charset="utf-8">
    <!-- Moved down to the bottom to have var id. -->
    <script type="text/javascript" src="morphic.js"></script>
    <script type="text/javascript" src="widgets.js"></script>
    <script type="text/javascript" src="blocks.js"></script>
    <script type="text/javascript" src="threads.js"></script>
    <script type="text/javascript" src="objects.js"></script>
    <script type="text/javascript" src="gui.js"></script>
    <script type="text/javascript" src="paint.js"></script>
    <script type="text/javascript" src="lists.js"></script>
    <script type="text/javascript" src="byob.js"></script>
    <script type="text/javascript" src="xml.js"></script>
    <script type="text/javascript" src="store.js"></script>
    <script type="text/javascript" src="locale.js"></script>
    <script type="text/javascript" src="cloud.js"></script>
    <script type="text/javascript" src="sha512.js"></script>
<script type="text/javascript" src="FileSaver.min.js"></script>
<script type="text/javascript" src="snap-edx-overrides.js"></script>

    <link rel="stylesheet" type="text/css" href="AG_status_bar.css" />
    <link rel="stylesheet" type="text/css" href="hintstyle.css" />

    <script type="text/javascript" src="AGAgent.js"></script>
    <script type="text/javascript" src='feedbackLog.js'></script>
    <script type='text/javascript'>
        var starter_path = null;
        // The id is to act as a course identifier.
        // NOTE: FOR NOW YOU ALSO HAVE TO ADD THE ID TO THE BOTTOM OF THE PAGE.
        var courseID = "BJC.1x";  // e.g. "BJCx"
        // Specify a prerequisite task id, should be null if no such requirement.
        var preReqTaskID = null;
        var preReqID = courseID + preReqTaskID;
        // taskID uniquely identifies the task for saving in browser sessionStorage.
        var taskID = "_W3_L2_T1_E_all";
        var id = courseID + taskID;
        var isEDX = isEDXurl();
        // if this question is not meant to be graded, change this flag to false
        var graded = true;
        // to hide feedback for this problem, change this flag to false
        var showFeedback = true;
        // to allow for the ability to regrade certain tests, change this flag to true
        var regradeOn = false;
        // Add tests to the outputLog. Function is called by runAGTest(id, outputLog)
        // var testLog;
        function AGTest(outputLog) {

            //NOTES TO YIFAT AND PATRICK:
            // No IO tests should be isolated. Which means that you have to check that the block
            // is on screen.
            // All getter/setter functions inside anonymous Assert functions.
            // Thanks for all your work :D
            //
            //
            //
            //
            // NAMING CONVENTIONS:
            //
            // **** VARIABLES ****
            // If you are going to make a variable like this:
            //
            // var turnExists = function() {
            //     return spriteContainsBlock("% !");
            // }
            //
            // please instead append a "_n" to the end, where the "n" is the chunk number associated
            // with the given function. So, if the "turnExists" function above were from chunk 2,
            // then please name it: "turnExists_2" and NOT JUST "turnExists" because if more than
            // one chunk has the same function called "turnExists", then bad things will happen bro.
            // **THE ONE EXCEPTION IS THE FEEDBACK LOG and WORLD** -- PLEASE HAVE THESE TWO LINES
            // AT THE TOP OF YOUR AGTEST() FUNCTION BODY:
            //
            // var fb = new FeedbackLog(null, id, 'this is a feedback log test', 0);
            // fb.snapWorld = world;
            //
            //
            //
            //
            // **** CHUNKS ****
            // please name chunks according to the exercise number they correspond to. For
            // example, if I am writing a chunk for exercise 3, name the chunk like this:
            //
            // chunk_3 = fb.newChunk('Make the block that exercise 3 is asking');
            //
            // so clarify it is "chunk_n" where 'n' is the number of the exercise.
            //
            //
            //
            //
            // **** TIPS ****
            // please name tips according to their chunk and which tip within that chunk
            // they are. So for example, if I am writing the second tip for chunk 4, then
            // please write it as:
            //
            // tip_4_2 = chunk_4.newTip("Make sure you name your block exactly...");
            //
            // to clarify, it is "tip_j_k" where "j" is the chunk number and "k" is
            // the tip number.
            //
            //
            //
            //
            // **** ASSERT TESTS ****
            // please do not assign these function calls to variables names. it is
            // uncessary and will result in more confusion. So for example, to create
            // a new ASSERT TEST, just do the following:
            //
            // tip_1_2.newAssertTest(
            //    multiplyExists_1,
            //    "Testing if there is a multiplication block in the factorial block.",
            //    "There is a multiplication block in the factorial block.",
            //    "Make sure you use the multiplication block in your factorial block.",
            //    1);
            //
            //
            //
            //
            // **** IO TESTS ****
            // same as the assert tests above. To create a new IO TEST, please don't
            // assign it a variable, just do the following:
            //
            // tip_1_4.newIOTest('r',  //testClass
            //     '% !',  //blockSpec
            //     [5],  //input
            //     120,  //output
            //     -1,  //timeout
            //     false,  //isolated
            //     1);  //points


            var fb = new FeedbackLog(null, id, 'this is a feedback log test', 0);
            fb.snapWorld = world;






        /* Create chunk_1 for the exercise 1 : factorial */
            var chunk_1 = fb.newChunk('Make the factorial block.');

            var factorialExists_1 = function() {
                return spriteContainsBlock("% !");
            }

            var multiplyExists_1 = function() {
                    return customBlockContains("% !", "%n Ã— %n");
            }

            var repeatExists_1 = function() {
                return customBlockContains("% !", "repeat %n %c") ||
                    customBlockContains("% !", "repeat until %b %c") ||
                    customBlockContains("% !", "for %upvar = %n to %n %cs");
            }
            // Add a first tip to that first test chunk
            var tip_1_1 = chunk_1.newTip('Make sure you name your block exactly "% !".',
                'Great job!');

            tip_1_1.newAssertTest(
                factorialExists_1,
                "Testing if there is a factorial block in the scripting area.",
                "There is a factorial block in the scripting area.",
                "Make sure your '% !' block is in the scripting area.",
                1);

            var tip_1_2 = chunk_1.newTip('Make sure to look at the definition of factorial to see what operations/blocks are necessary.',
                'Great job!');

            tip_1_2.newAssertTest(
                multiplyExists_1,
                "Testing if there is a multiplication block in the factorial block.",
                "There is a multiplication block in the factorial block.",
                "Make sure you use the multiplication block in your factorial block.",
                1);

            tip_1_2.newAssertTest(
                repeatExists_1,
                "Testing if there is a loop in the factorial block.",
                "There is a loop block in the factorial block.",
                "Make sure you use a loop block in the factorial block.",
                1);

            var tip_1_3 = chunk_1.newTip('Make sure it works on edge cases!',
                'Great job!');

             tip_1_3.newIOTest('r',  //testClass
                '% !',  //blockSpec
                [0],  //input
                1,  //output
                -1,  //timeout
                false,  //isolated
                1);  //points

             var tip_1_4 = chunk_1.newTip('Make sure it works on basic inputs.',
                'Great job!');

             tip_1_4.newIOTest('r',  //testClass
                '% !',  //blockSpec
                [1],  //input
                1,  //output
                -1,  //timeout
                false,  //isolated
                1);  //points

             tip_1_4.newIOTest('r',  //testClass
                '% !',  //blockSpec
                [2],  //input
                2,  //output
                -1,  //timeout
                false,  //isolated
                1);  //points

             tip_1_4.newIOTest('r',  //testClass
                '% !',  //blockSpec
                [3],  //input
                6,  //output
                -1,  //timeout
                false,  //isolated
                1);  //points

             tip_1_4.newIOTest('r',  //testClass
                '% !',  //blockSpec
                [4],  //input
                24,  //output
                -1,  //timeout
                false,  //isolated
                1);  //points

             tip_1_4.newIOTest('r',  //testClass
                '% !',  //blockSpec
                [5],  //input
                120,  //output
                -1,  //timeout
                false,  //isolated
                1);  //points










        /* Adding chunk_8 for exercise 8: triangular number */
            // Create a first test chunk
            var chunk_8 = fb.newChunk('Make the triangular number block.');

            var triangularNumberExists_8 = function() {
                return spriteContainsBlock("triangular number %");
            }
            
            var addExists_8 = function() {
                    return customBlockContains("triangular number %", "%n + %n") || customBlockContains("triangular number %", "change %var by %n") || customBlockContains("triangular number %", "set %var to %s");
            }
            // Add a first tip to that first test chunk
            var tip_8_1 = chunk_8.newTip('Make sure you name your block exactly "triangular number %".',
                'Great job!');

            tip_8_1.newAssertTest(
                triangularNumberExists_8,
                "Testing if there is a triangular number block in the scripting area.",
                "There is a triangular number block in the scripting area.",
                "Make sure your 'triangular number %' is in the scripting area.",
                1);

            var tip_8_2 = chunk_8.newTip('Make sure to look at the definition of triangular number to see what operations/blocks are necessary.',
                'Great job!');

            tip_8_2.newAssertTest(
                addExists_8,
                "Testing if there is an addition block in the triangular number block.",
                "There is an addition block in the triangular number block.",
                "Make sure you perform some form of addition in your triangular number block.",
                1);

             var tip_8_3 = chunk_8.newTip('Make sure it works on basic inputs.',
                'Great job!');

             tip_8_3.newIOTest('r',  //testClass
                'triangular number %',  //blockSpec
                [0],  //input
                0,  //output
                -1,  //timeout
                false,  //isolated
                1);  //points

             tip_8_3.newIOTest('r',  //testClass
                'triangular number %',  //blockSpec
                [1],  //input
                1,  //output
                -1,  //timeout
                false,  //isolated
                1);  //points

             tip_8_3.newIOTest('r',  //testClass
                'triangular number %',  //blockSpec
                [2],  //input
                3,  //output
                -1,  //timeout
                false,  //isolated
                1);  //points

             tip_8_3.newIOTest('r',  //testClass
                'triangular number %',  //blockSpec
                [3],  //input
                6,  //output
                -1,  //timeout
                false,  //isolated
                1);  //points

             tip_8_3.newIOTest('r',  //testClass
                'triangular number %',  //blockSpec
                [4],  //input
                10,  //output
                -1,  //timeout
                false,  //isolated
                1);  //points

             tip_8_3.newIOTest('r',  //testClass
                'triangular number %',  //blockSpec
                [5],  //input
                15,  //output
                -1,  //timeout
                false,  //isolated
                1);  //points






        /* Chunk_10 is the "number of divisors" block, exercise 10 */
            var chunk_10 = fb.newChunk('Make the number-of-divisors block.');

            var numberOfDivisorsExists_10 = function () {
                return spriteContainsBlock("number-of-divisors %");
            }

            var containsForLoop_10 = function () {
                var funcBody = getCustomBody("number-of-divisors %");
                return scriptContainsBlock(funcBody, "for % = % to % %");
            }
            var containsMod_10 = function () {
                var funcBody = getCustomBody("number-of-divisors %");
                return scriptContainsBlock(funcBody, "% mod %");
            }
            var containsScriptVars_10 = function () {
                var funcBody = getCustomBody("number-of-divisors %");
                return scriptContainsBlock(funcBody, "script variables %");
            }

            var tip_10_1 = chunk_10.newTip('Make sure you create and name your block exactly number-of-divisors %.',
                'Great job!');

            tip_10_1.newAssertTest(
                numberOfDivisorsExists_10,
                "Testing if there is a 'number-of-divisors %' block.",
                "There is a 'number-of-divisors %' block in the scripting area.",
                "Make sure you create and name your block exactly 'number-of-divisors %' and have it in the scripting area.",
                1);

            var tip_10_2 = chunk_10.newTip('Try checking that your function body contains key blocks.',
                'Great job!');

            tip_10_2.newAssertTest(
                containsForLoop_10,
                "Testing if there is a for loop inside of the body definition",
                "There is a for loop inside the body.",
                "If you are stuck on trying to figure out how to check every value, try a for-loop.",
                1);

            tip_10_2.newAssertTest(
                containsMod_10,
                "Testing if there is a mod block inside of the body definition",
                "There is a mod block inside the body.",
                "If you are stuck on trying to figure out how to check if a given number divides your input, try using the mod block.",
                1);

            tip_10_2.newAssertTest(
                containsScriptVars_10,
                "Testing if there are script variables inside of the body definition",
                "There are script variables inside the body.",
                "If you are stuck on trying to figure out how to keep a running count of how the total number of divisors, try using a script variable!",
                1);

            var tip_10_3 = chunk_10.newTip('Make sure it works on basic inputs.',
                'Great job!');

            // Number-of-divisors: Make sure your function works for positive numbers!
            tip_10_3.newIOTest('r',  //testClass
                'number-of-divisors %',  //blockSpec
                [8],  //input
                4,  //output
                -1,  //timeout
                false,  //isolated
                1);  //points

            tip_10_3.newIOTest('r',  //testClass
                'number-of-divisors %',  //blockSpec
                [11],  //input
                2,  //output
                -1,  //timeout
                false,  //isolated
                1);  //points

            tip_10_3.newIOTest('r',  //testClass
                'number-of-divisors %',  //blockSpec
                [3],  //input
                2,  //output
                -1,  //timeout
                false,  //isolated
                1);  //points





        /* Chunk_11 is the "number of divisors" block, exercise 11 */

            var chunk_11 = fb.newChunk('Make the digital-sum block.');

            var digitalSumExists_11 = function () {
                return spriteContainsBlock("digital sum %");
            }
            var containsForLoop_11 = function () {
                var funcBody = getCustomBody("digital sum %");
                return scriptContainsBlock(funcBody, "for % = % to % %");
            }
            var containsScriptVars_11 = function () {
                var funcBody = getCustomBody("digital sum %");
                return scriptContainsBlock(funcBody, "script variables %");
            }




            var tip_11_1 = chunk_11.newTip('Make sure you create and name your block exactly digital sum %.',
                'Great job!');

            tip_11_1.newAssertTest(
                digitalSumExists_11,
                "Testing if there is a 'digital sum %' block.",
                "There is a 'digital-sum %' block in the scripting area.",
                "Make sure you create and name your block exactly 'digital-sum' and have it in the scripting area.",
                1);

            var tip_11_2 = chunk_11.newTip('Try checking that your function body contains key blocks.',
                'Great job!');

            tip_11_2.newAssertTest(
                containsForLoop_11,
                "Testing if there is a for-loop inside the definition.",
                "There is a for-loop inside the definition.",
                "If you are stuck on trying to figure out how to iterate through every digit, try a for-loop!",
                1);

            tip_11_2.newAssertTest(
                containsScriptVars_11,
                "Testing if there is a script variables block inside the definition.",
                "There is a script variables block inside the definition.",
                "If you are stuck on trying to figure out how to keep a running count of the total digital sum, try using a script variable.",
                1);

            var tip_11_3 = chunk_11.newTip('Try checking that your function body contains key blocks.',
                'Great job!');

            tip_11_3.newIOTest('r',  //testClass
                'digital sum %',  //blockSpec
                [55],  //input
                10,  //output
                -1,  //timeout
                false,  //isolated
                1);  //points

            tip_11_3.newIOTest('r',  //testClass
                'digital sum %',  //blockSpec
                [123],  //input
                6,  //output
                -1,  //timeout
                false,  //isolated
                1);  //points

            tip_11_3.newIOTest('r',  //testClass
                'digital sum %',  //blockSpec
                [1003],  //input
                4,  //output
                -1,  //timeout
                false,  //isolated
                1);  //points







        /* Chunk_12 is the "multuples of 7" block, exercise 12 */
            var chunk_12 = fb.newChunk('Make the multiples of 7 algorithm block.');

            var multiplesOf7Exists_12 = function () {
                return spriteContainsBlock("multiples of 7 algorithm %");
            }

            var notContainsModBlock_12 = function () {
                var multiplesOf7Body = getCustomBody('multiples of 7 algorithm %');
                if (multiplesOf7Body === undefined) {
                    return false;
                }
                var modBlockFound = scriptContainsBlock(multiplesOf7Body, '% mod %');
                if (modBlockFound) {
                    return false;
                }
                return true;
            }

            var containsScriptVars_12 = function () {
                var multiplesOf7Body = getCustomBody('multiples of 7 algorithm %');
                return scriptContainsBlock(multiplesOf7Body, "script variables %");
            }




            var tip_12_1 = chunk_12.newTip('Make sure you create and name your block exactly multiples of 7 algorithm %.',
                'Great job!');


            tip_12_1.newAssertTest(
                multiplesOf7Exists_12,
                "Testing if there is a 'multiples of 7 algorithm %' block.",
                "There is a 'multiples of 7 algorithm %' block in the scripting area.",
                "Make sure you create and name your block exactly 'multiples of 7 algorithm %' in the scripting area.",
                1);

            var tip_12_2 = chunk_12.newTip('Try checking that your function body contains key blocks.',
                'Great job!');

            tip_12_2.newAssertTest(
                notContainsModBlock_12,
                "Testing if there is a not '% mod %' block inside the definition of 'multiples of 7 algorithm %'.",
                "There is a not '% mod %' block inside the definition of 'multiples of 7 algorithm %'.",
                "Try making the function without using a '% mod %' block. A repeat-until block sounds like it could work. Also look at the blocks on the screen in the exercise that we suggest.",
                1);

            tip_12_2.newAssertTest(
                containsScriptVars_12,
                "Testing if there is a script variables block inside the definition.",
                "There is a script variables block inside the definition.",
                "If you are stuck on trying to figure out how to keep track of the digits, try using script variables",
                1);

            var tip_12_3 = chunk_12.newTip('Checking that your function works for numbers greater than 21.',
                'Great job!');

            tip_12_3.newIOTest('r',  //testClass
                'multiples of 7 algorithm %',  //blockSpec
                [501298],  //input
                -14,  //output
                -1,  //timeout
                false,  //isolated
                1);  //points

            tip_12_3.newIOTest('r',  //testClass
                'multiples of 7 algorithm %',  //blockSpec
                [28],  //input
                -14,  //output
                -1,  //timeout
                false,  //isolated
                1);  //points

            tip_12_3.newIOTest('r',  //testClass
                'multiples of 7 algorithm %',  //blockSpec
                [23],  //input
                -4,  //output
                -1,  //timeout
                false,  //isolated
                1);  //points

            tip_12_3.newIOTest('r',  //testClass
                'multiples of 7 algorithm %',  //blockSpec
                [35],  //input
                -7,  //output
                -1,  //timeout
                false,  //isolated
                1);  //points

            var tip_12_4 = chunk_12.newTip('Checking that your function works for 21.',
                'Great job!');

            tip_12_4.newIOTest('r',  //testClass
                'multiples of 7 algorithm %',  //blockSpec
                [21],  //input
                0,  //output
                -1,  //timeout
                false,  //isolated
                1);  //points

            var tip_12_5 = chunk_12.newTip('Checking that your function works for numbers less than 21.',
                'Great job!');

            tip_12_5.newIOTest('r',  //testClass
                'multiples of 7 algorithm %',  //blockSpec
                [14],  //input
                14,  //output
                -1,  //timeout
                false,  //isolated
                1);  //points

            tip_12_5.newIOTest('r',  //testClass
                'multiples of 7 algorithm %',  //blockSpec
                [10],  //input
                10,  //output
                -1,  //timeout
                false,  //isolated
                1);  //points

            tip_12_5.newIOTest('r',  //testClass
                'multiples of 7 algorithm %',  //blockSpec
                [-4],  //input
                -4,  //output
                -1,  //timeout
                false,  //isolated
                1);  //points

            tip_12_5.newIOTest('r',  //testClass
                'multiples of 7 algorithm %',  //blockSpec
                [-90],  //input
                -90,  //output
                -1,  //timeout
                false,  //isolated
                1);  //points




            return fb;
        }
    </script>
    <script type="text/javascript" src='feedbackLog.js'></script>
    <script type="text/javascript" src="AGFormatting.js"></script>

    <script type="text/javascript">

        var world;
        window.onload = function () {

            //INITIALIZE UP SNAP
            world = new WorldMorph(document.getElementById('world'));
            new IDE_Morph().openIn(world);
            var ide = world.children[0];

            //Reduce Stage Size on initialization
            ide.toggleStageSize(true);

            initializeSnapAdditions(world, id);


            //AUTOGRADER ADDITION -
            //Forced to use setTimeout() to let the world load before... Maybe not.
            //Create a gradingLog and initialize the AG status bar (AGSB).

            //Initialize AGSB button.
            var grade_button = document.getElementById("autograding_button");
            grade_button.addEventListener('click', doExecAndDisplayTests);
            var world_canvas = document.getElementById('world');
            world_canvas.addEventListener("mouseup", update_listener);
            // Start Snap Environment Loop
            setInterval(loop, 1);

        };

        function loop() {
            world.doOneCycle();
        }

    </script>
    <script type="text/javascript" src='feedbackLog.js'></script>
    <script type="text/javascript" src="AG_EDX.js"></script>
</head>
<body style="margin: 0;">
    <canvas id="world" tabindex="1" style="position: absolute;" ></canvas>

<!-- Snap Autograding Button -->
<div id="autograding_bar">
    <div tabindex="0" class="ag-action-menu" id='ag-action-menu' style="display:inline-block">
        <span title="Menu">&#9776;</span>
        <div class='hover_darken'></div>
      <nav id="navigation" class="site-navigation" role="navigation">
          <ul id="dropdown-closed" class="bubble">
            <!--<li class="menu-item-sub-menu" id="enabled-button"><a id="feedback-button">View Feedback</a></li>
            <li class="menu-divider-sub-menu" id='menu-divider'></li>-->
            <li class="menu-item-sub-menu" id="enabled-button"><a id="undo-button">Revert To Last Attempt</a></li>
            <li class="menu-item-sub-menu" id="enabled-button"><a id="revert-button">Revert To Best Attempt</a></li>
            <!--<li class="menu-item-sub-menu" id="enabled-button"><a id="last-submit">Revert To Last edX Submission</a></li>-->
            <li class="menu-item-sub-menu" id="enabled-button"><a id="reset-button">Reset</a></li>
            <li class="menu-divider-sub-menu" id='menu-divider'></li>
            <li class="menu-item-sub-menu" id='enabled-button' onclick="openPopup();"><a id="help-button">Help</a></li>
          </ul>
    </nav>
    </div>
    <div id="autograding_button" style="display:inline-block;">
        <span></span>
        <div class='hover_darken'></div>
    </div>
    <div id="numtips" style="display:inline-block"></div>
</div>
<!-- Snap Autograding Menu -->
<!-- Autograding Menu Help Button -->
<div class="overlay hidden" id="overlay">
    <p class="help-text" id="full-screen-arrow">&#8600;</p>
    <p class="help-text" id="full-screen-help">This full-screen button will pop out the Snap! window.</p>
    <p class="help-text" id="menu-item-arrow">&#8599;</p>
    <p class="help-text" id="menu-item-help">The first two menu items will revert your current Snap! state to one of your previous attempts, depending on whether you wish to revert to your last graded attempt or to your best attempt.</br></br>The 'Reset' button will revert to a blank Snap! project, or to a provided starter file if one is given for this problem.</p>
    <p class="help-text" id="ag-button-arrow">&#8593;</p>
    <p class="help-text" id="ag-button-help">Clicking this button will grade your current attempt and send the results to edX.</p>
</div>

<div style="display:inline-block" class="view-results" id="circle" onclick="openResults();">Results
</div>
<div class="overlay hidden" id="ag-output">
    <div class="popup-content" id="ag-results">
        <span class="button-close" onclick="closeResults();" id="popup">X</span>
        <!--<p id = "different-feedback"></p>
        <p id = "edx-submit-different"></p>-->
        <div id="toggle-correct-tests"></div>
        <p id="comment"></p>
    </div>
</div>
    </div>
    <script type="text/javascript" src="AG_status_bar.js" />
</body>
</html>